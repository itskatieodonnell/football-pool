<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL Pick 'Em Pool Manager 2025 - Full 18 Weeks</title>
    <style>
        /* Complete 18-Week NFL Pick-Em Pool Styles */
        :root {
            --nfl-blue: #013369;
            --nfl-red: #D50A0A;
            --nfl-silver: #869397;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
            --bg-light: #f8f9fa;
            --bg-dark: #343a40;
            --text-dark: #212529;
            --border-color: #dee2e6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* Notification System */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 1000;
            max-width: 400px;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .notification.success {
            background: var(--success-green);
            color: white;
        }

        .notification.error {
            background: var(--danger-red);
            color: white;
        }

        .notification.info {
            background: var(--nfl-blue);
            color: white;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--nfl-blue) 0%, #041E42 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(1,51,105,0.3);
        }

        .header h1 { 
            font-size: 2.8em; 
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .season-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .info-label { font-size: 0.9em; opacity: 0.8; margin-bottom: 5px; }
        .info-value { font-size: 1.4em; font-weight: bold; }

        /* Week Status Banner */
        .week-status {
            background: var(--success-green);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(40,167,69,0.3);
        }

        .week-status.locked { background: var(--danger-red); }
        .week-status.in-progress { background: var(--warning-orange); color: var(--text-dark); }

        /* Navigation */
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            border-radius: 10px;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: 120px;
        }

        .nav-tab:hover { background-color: var(--bg-light); transform: translateY(-2px); }
        .nav-tab.active { 
            background: var(--nfl-blue); 
            color: white; 
            box-shadow: 0 4px 15px rgba(1,51,105,0.3);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            min-height: 600px;
        }

        .tab-content.active { display: block; }

        /* Week Controls */
        .week-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-light);
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .week-display {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--nfl-blue);
            text-align: center;
            flex: 1;
        }

        .week-nav {
            display: flex;
            gap: 10px;
        }

        .deadline-info {
            background: var(--warning-orange);
            color: var(--text-dark);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        /* Games Interface */
        .player-selector {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .player-selector label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--nfl-blue);
        }

        .player-selector select {
            width: 100%;
            max-width: 400px;
            padding: 12px 15px;
            font-size: 1.1em;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background-color: white;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .game-card {
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            background: white;
            position: relative;
        }

        .game-card:hover {
            border-color: var(--nfl-blue);
            box-shadow: 0 8px 25px rgba(1,51,105,0.15);
            transform: translateY(-2px);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .game-time {
            font-size: 0.9em;
            color: var(--nfl-silver);
            font-weight: bold;
        }

        .game-network {
            background: var(--nfl-blue);
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .matchup {
            text-align: center;
            margin: 20px 0;
        }

        .team-line {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }

        .team-name {
            font-size: 1.1em;
            font-weight: bold;
        }

        .pick-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .pick-btn {
            padding: 12px 25px;
            border: 3px solid var(--nfl-blue);
            background: white;
            color: var(--nfl-blue);
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            min-width: 100px;
        }

        .pick-btn:hover:not(.disabled) {
            background: var(--nfl-blue);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(1,51,105,0.3);
        }

        .pick-btn.selected {
            background: var(--success-green);
            border-color: var(--success-green);
            color: white;
            box-shadow: 0 0 20px rgba(40,167,69,0.4);
        }

        .pick-btn.disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #f8f9fa;
            color: #6c757d;
            border-color: #e9ecef;
        }

        .constraints-section {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
        }

        .constraints-section h4 {
            color: var(--nfl-blue);
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .used-teams {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .used-team {
            background: var(--danger-red);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .remaining-count {
            font-size: 1.1em;
            color: var(--success-green);
            font-weight: bold;
        }

        /* Buttons */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn--primary {
            background: var(--nfl-blue);
            color: white;
            box-shadow: 0 4px 15px rgba(1,51,105,0.3);
        }

        .btn--primary:hover {
            background: #041E42;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(1,51,105,0.4);
        }

        .btn--success {
            background: var(--success-green);
            color: white;
        }

        .btn--success:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn--danger {
            background: var(--danger-red);
            color: white;
        }

        .btn--danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .btn--outline {
            background: transparent;
            color: var(--nfl-blue);
            border: 2px solid var(--nfl-blue);
        }

        .btn--outline:hover {
            background: var(--nfl-blue);
            color: white;
        }

        .btn--lg {
            padding: 15px 35px;
            font-size: 1.2em;
        }

        .btn--sm {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Form Elements */
        .form-row {
            display: flex;
            gap: 15px;
            align-items: end;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--nfl-blue);
            box-shadow: 0 0 0 3px rgba(1,51,105,0.1);
        }

        /* Admin Styles */
        .admin-header {
            background: linear-gradient(135deg, var(--nfl-blue), #041E42);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }

        .admin-section {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .admin-section h3 {
            color: var(--nfl-blue);
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid var(--bg-light);
            padding-bottom: 10px;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: var(--bg-light);
            border-radius: 8px;
            margin-bottom: 10px;
            transition: background-color 0.3s ease;
        }

        .player-item:hover {
            background: #e9ecef;
        }

        .player-info {
            flex: 1;
        }

        .player-name {
            font-weight: bold;
            color: var(--nfl-blue);
            font-size: 1.1em;
        }

        .player-stats {
            color: var(--nfl-silver);
            font-size: 0.9em;
            margin-top: 2px;
        }

        /* Week Progress Indicator */
        .week-progress {
            background: var(--bg-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-green);
            transition: width 0.3s ease;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        th {
            background: var(--nfl-blue);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: bold;
            font-size: 0.95em;
        }

        td {
            padding: 15px 12px;
            border-bottom: 1px solid var(--border-color);
        }

        tr:hover {
            background: var(--bg-light);
        }

        tr:last-child td {
            border-bottom: none;
        }

        .rank-cell {
            font-weight: bold;
            font-size: 1.1em;
            color: var(--nfl-blue);
        }

        .points-cell {
            font-weight: bold;
            font-size: 1.2em;
            color: var(--success-green);
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--nfl-silver);
            font-style: italic;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 2.2em; }
            .season-info { grid-template-columns: 1fr; }
            .nav-tabs { flex-direction: column; }
            .nav-tab { margin-bottom: 5px; }
            .week-controls { flex-direction: column; text-align: center; }
            .games-grid { grid-template-columns: 1fr; }
            .pick-options { flex-direction: column; }
            .pick-btn { width: 100%; }
            .form-row { flex-direction: column; }
            .player-item { flex-direction: column; gap: 10px; text-align: center; }
            .notification { right: 10px; left: 10px; max-width: none; }
        }

        /* Submit Pick Section */
        .submit-section {
            text-align: center;
            padding: 30px;
            background: var(--bg-light);
            border-radius: 12px;
            margin-top: 30px;
        }

        /* Season Calendar */
        .season-calendar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .calendar-week {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .calendar-week:hover {
            border-color: var(--nfl-blue);
            transform: translateY(-2px);
        }

        .calendar-week.active {
            background: var(--nfl-blue);
            color: white;
        }

        .calendar-week.completed {
            background: var(--success-green);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 id="main-title">🏈 2025 NFL Pick 'Em Pool - Complete Season</h1>
            <div class="season-info">
                <div class="info-card">
                    <div class="info-label">Pool Size</div>
                    <div class="info-value" id="pool-size">0 players</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Total Pot</div>
                    <div class="info-value" id="total-pot">$0</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Current Week</div>
                    <div class="info-value" id="current-week-display">Week 1</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Season Progress</div>
                    <div class="info-value" id="season-progress">Week 1 of 18</div>
                </div>
            </div>
        </header>

        <!-- Week Progress -->
        <div class="week-progress">
            <div><strong>2025 NFL Season Progress</strong></div>
            <div class="progress-bar">
                <div class="progress-fill" id="season-progress-bar" style="width: 5.56%"></div>
            </div>
            <div style="margin-top: 8px; font-size: 0.9em; color: var(--nfl-silver);">
                <span id="weeks-completed">0</span> weeks completed • <span id="weeks-remaining">18</span> weeks remaining
            </div>
        </div>

        <!-- Week Status Banner -->
        <div id="week-status" class="week-status">
            <span id="status-text">Week 1 - Picks Open</span>
        </div>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="picks">Weekly Picks</button>
            <button class="nav-tab" data-tab="standings">Standings</button>
            <button class="nav-tab" data-tab="calendar">Season Calendar</button>
            <button class="nav-tab" data-tab="team-tracker">Team Tracker</button>
            <button class="nav-tab" data-tab="admin" id="admin-tab" style="display: none;">Admin</button>
        </nav>

        <!-- Weekly Picks Tab -->
        <div id="picks" class="tab-content active">
            <div class="week-controls">
                <div class="week-nav">
                    <button id="prev-week" class="btn btn--outline btn--sm">← Previous Week</button>
                </div>
                <div class="week-display">
                    <div id="week-title">Week 1</div>
                    <div class="deadline-info" id="pick-deadline">
                        Picks due: Thursday, Sep 4 at 7:20 PM ET
                    </div>
                </div>
                <div class="week-nav">
                    <button id="next-week" class="btn btn--outline btn--sm">Next Week →</button>
                </div>
            </div>

            <div class="player-selector">
                <label for="current-player">Select Player to Make Pick:</label>
                <select id="current-player">
                    <option value="">Choose a player...</option>
                </select>
            </div>

            <div id="games-container">
                <div id="games-display">
                    <p style="text-align: center; color: var(--nfl-silver); padding: 40px;">
                        Select a player above to see games and make picks for Week <span id="display-week-number">1</span>.
                    </p>
                </div>
            </div>

            <div id="constraints-section" class="constraints-section" style="display: none;">
                <h4>Team Constraints for <span id="selected-player-name"></span></h4>
                <div>
                    <strong>Teams Already Used:</strong>
                    <div class="used-teams" id="used-teams-display">
                        <em>No teams used yet</em>
                    </div>
                </div>
                <div class="remaining-count" id="remaining-teams-count"></div>
            </div>

            <div id="submit-section" class="submit-section" style="display: none;">
                <button id="submit-pick" class="btn btn--success btn--lg">
                    Submit Pick for Week <span id="submit-week-number">1</span>
                </button>
            </div>
        </div>

        <!-- Standings Tab -->
        <div id="standings" class="tab-content">
            <h2>Season Standings</h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Player</th>
                            <th>Points</th>
                            <th>W-L Record</th>
                            <th>Teams Used</th>
                            <th>Teams Remaining</th>
                        </tr>
                    </thead>
                    <tbody id="standings-tbody">
                        <tr>
                            <td colspan="6" class="loading">Loading standings...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Season Calendar Tab -->
        <div id="calendar" class="tab-content">
            <h2>2025 NFL Season Calendar</h2>
            <p style="margin-bottom: 20px; color: var(--nfl-silver);">
                Click on any week to jump directly to that week's games and picks.
            </p>
            <div id="season-calendar" class="season-calendar">
                <!-- Calendar will be populated by JavaScript -->
            </div>
        </div>

        <!-- Team Tracker Tab -->
        <div id="team-tracker" class="tab-content">
            <h2>Team Usage Matrix</h2>
            <p style="margin-bottom: 20px; color: var(--nfl-silver);">
                Track which teams each player has used throughout the season.
            </p>
            <div id="team-matrix-container">
                <div class="loading">Select players in Weekly Picks to see team usage</div>
            </div>
        </div>

        <!-- Admin Tab -->
        <div id="admin" class="tab-content">
            <div class="admin-header">
                <h2>🔐 Pool Administration</h2>
                <p>Complete control panel for your 18-week NFL Pick 'Em Pool</p>
            </div>

            <!-- Player Management -->
            <div class="admin-section">
                <h3>Player Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="new-player-name">Add New Player</label>
                        <input type="text" id="new-player-name" placeholder="Enter player name">
                    </div>
                    <button id="add-player" class="btn btn--primary">Add Player</button>
                </div>
                <div id="player-list">
                    <div class="loading">Loading players...</div>
                </div>
            </div>

            <!-- Week Management -->
            <div class="admin-section">
                <h3>Week Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="admin-current-week">Current Week</label>
                        <select id="admin-current-week">
                            <option value="1">Week 1</option>
                            <option value="2">Week 2</option>
                            <option value="3">Week 3</option>
                            <option value="4">Week 4</option>
                            <option value="5">Week 5</option>
                            <option value="6">Week 6</option>
                            <option value="7">Week 7</option>
                            <option value="8">Week 8</option>
                            <option value="9">Week 9</option>
                            <option value="10">Week 10</option>
                            <option value="11">Week 11</option>
                            <option value="12">Week 12</option>
                            <option value="13">Week 13</option>
                            <option value="14">Week 14</option>
                            <option value="15">Week 15</option>
                            <option value="16">Week 16</option>
                            <option value="17">Week 17</option>
                            <option value="18">Week 18</option>
                        </select>
                    </div>
                    <button id="update-week" class="btn btn--primary">Update Week</button>
                    <button id="advance-week" class="btn btn--success">Advance to Next Week</button>
                </div>
            </div>

            <!-- Pool Settings -->
            <div class="admin-section">
                <h3>Pool Settings</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="entry-fee">Entry Fee ($)</label>
                        <input type="number" id="entry-fee" value="20" min="1" max="1000">
                    </div>
                    <button id="update-settings" class="btn btn--primary">Update Settings</button>
                </div>

                <div class="form-row">
                    <button id="reset-pool" class="btn btn--danger">Reset Entire Pool</button>
                    <button id="clear-picks" class="btn btn--outline">Clear All Picks</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete 18-Week NFL Pick-Em Pool System
        console.log('🏈 NFL Pick-Em Pool Complete 18-Week Version Loading...');

        class Complete18WeekPickEmPool {
            constructor() {
                this.currentWeek = 1;
                this.maxWeeks = 18;
                this.entryFee = 20;
                this.players = [];
                this.selectedTeam = null;
                this.selectedPlayer = null;
                this.notificationTimeout = null;

                // Complete 18-week NFL schedule
                this.nflSchedule = this.initializeCompleteSchedule();

                // Prevent multiple initialization
                if (window.poolInitialized) return;
                window.poolInitialized = true;

                this.init();
            }

            initializeCompleteSchedule() {
                return {
                    1: {
                        week_number: 1,
                        start_date: "2025-09-04",
                        games: [
                            {away: "Dallas Cowboys", home: "Philadelphia Eagles", date: "Thursday, Sep 4", time: "8:20 PM ET", network: "NBC"},
                            {away: "Kansas City Chiefs", home: "Los Angeles Chargers", date: "Friday, Sep 5", time: "8:00 PM ET", network: "YouTube"},
                            {away: "Las Vegas Raiders", home: "New England Patriots", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "CBS"},
                            {away: "Pittsburgh Steelers", home: "New York Jets", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "CBS"},
                            {away: "Miami Dolphins", home: "Indianapolis Colts", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "CBS"},
                            {away: "Arizona Cardinals", home: "New Orleans Saints", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "CBS"},
                            {away: "New York Giants", home: "Washington Commanders", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "FOX"},
                            {away: "Tampa Bay Buccaneers", home: "Atlanta Falcons", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "FOX"},
                            {away: "Cincinnati Bengals", home: "Cleveland Browns", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "FOX"},
                            {away: "Carolina Panthers", home: "Jacksonville Jaguars", date: "Sunday, Sep 7", time: "1:00 PM ET", network: "FOX"},
                            {away: "Tennessee Titans", home: "Denver Broncos", date: "Sunday, Sep 7", time: "4:05 PM ET", network: "FOX"},
                            {away: "San Francisco 49ers", home: "Seattle Seahawks", date: "Sunday, Sep 7", time: "4:05 PM ET", network: "FOX"},
                            {away: "Detroit Lions", home: "Green Bay Packers", date: "Sunday, Sep 7", time: "4:25 PM ET", network: "CBS"},
                            {away: "Houston Texans", home: "Los Angeles Rams", date: "Sunday, Sep 7", time: "4:25 PM ET", network: "CBS"},
                            {away: "Baltimore Ravens", home: "Buffalo Bills", date: "Sunday, Sep 7", time: "8:20 PM ET", network: "NBC"},
                            {away: "Minnesota Vikings", home: "Chicago Bears", date: "Monday, Sep 8", time: "8:15 PM ET", network: "ABC/ESPN"}
                        ]
                    },
                    2: {
                        week_number: 2,
                        start_date: "2025-09-11",
                        games: [
                            {away: "Washington Commanders", home: "Green Bay Packers", date: "Thursday, Sep 11", time: "8:15 PM ET", network: "Prime Video"},
                            {away: "Cleveland Browns", home: "Baltimore Ravens", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "CBS"},
                            {away: "New England Patriots", home: "Miami Dolphins", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "CBS"},
                            {away: "Indianapolis Colts", home: "Tennessee Titans", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "CBS"},
                            {away: "New York Jets", home: "Buffalo Bills", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "CBS"},
                            {away: "Chicago Bears", home: "Detroit Lions", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "FOX"},
                            {away: "Atlanta Falcons", home: "Carolina Panthers", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "FOX"},
                            {away: "Jacksonville Jaguars", home: "Tampa Bay Buccaneers", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "FOX"},
                            {away: "New Orleans Saints", home: "New York Giants", date: "Sunday, Sep 14", time: "1:00 PM ET", network: "FOX"},
                            {away: "Los Angeles Rams", home: "Arizona Cardinals", date: "Sunday, Sep 14", time: "4:05 PM ET", network: "FOX"},
                            {away: "Seattle Seahawks", home: "Denver Broncos", date: "Sunday, Sep 14", time: "4:05 PM ET", network: "FOX"},
                            {away: "Los Angeles Chargers", home: "Las Vegas Raiders", date: "Sunday, Sep 14", time: "4:25 PM ET", network: "CBS"},
                            {away: "Pittsburgh Steelers", home: "Houston Texans", date: "Sunday, Sep 14", time: "4:25 PM ET", network: "CBS"},
                            {away: "Philadelphia Eagles", home: "Kansas City Chiefs", date: "Sunday, Sep 14", time: "4:25 PM ET", network: "CBS"},
                            {away: "San Francisco 49ers", home: "Minnesota Vikings", date: "Sunday, Sep 14", time: "8:20 PM ET", network: "NBC"},
                            {away: "Cincinnati Bengals", home: "Dallas Cowboys", date: "Monday, Sep 15", time: "8:15 PM ET", network: "ABC/ESPN"}
                        ]
                    },
                    3: {
                        week_number: 3,
                        start_date: "2025-09-18",
                        games: [
                            {away: "Miami Dolphins", home: "Seattle Seahawks", date: "Thursday, Sep 18", time: "8:15 PM ET", network: "Prime Video"},
                            {away: "Buffalo Bills", home: "Jacksonville Jaguars", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "CBS"},
                            {away: "Baltimore Ravens", home: "Cincinnati Bengals", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "CBS"},
                            {away: "Houston Texans", home: "Indianapolis Colts", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "CBS"},
                            {away: "Tennessee Titans", home: "New England Patriots", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "CBS"},
                            {away: "Detroit Lions", home: "Atlanta Falcons", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "FOX"},
                            {away: "Green Bay Packers", home: "New York Giants", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "FOX"},
                            {away: "Carolina Panthers", home: "New Orleans Saints", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "FOX"},
                            {away: "Tampa Bay Buccaneers", home: "Chicago Bears", date: "Sunday, Sep 21", time: "1:00 PM ET", network: "FOX"},
                            {away: "Arizona Cardinals", home: "San Francisco 49ers", date: "Sunday, Sep 21", time: "4:05 PM ET", network: "FOX"},
                            {away: "Denver Broncos", home: "Los Angeles Chargers", date: "Sunday, Sep 21", time: "4:05 PM ET", network: "FOX"},
                            {away: "Las Vegas Raiders", home: "Kansas City Chiefs", date: "Sunday, Sep 21", time: "4:25 PM ET", network: "CBS"},
                            {away: "Los Angeles Rams", home: "Pittsburgh Steelers", date: "Sunday, Sep 21", time: "4:25 PM ET", network: "CBS"},
                            {away: "Washington Commanders", home: "Philadelphia Eagles", date: "Sunday, Sep 21", time: "8:20 PM ET", network: "NBC"},
                            {away: "Dallas Cowboys", home: "Minnesota Vikings", date: "Monday, Sep 22", time: "8:15 PM ET", network: "ABC/ESPN"},
                            {away: "New York Jets", home: "New York Giants", date: "Monday, Sep 22", time: "8:15 PM ET", network: "ABC/ESPN"}
                        ]
                    }
                };

                // Generate remaining weeks 4-18 with template structure
                const months = ['Sep', 'Oct', 'Oct', 'Oct', 'Nov', 'Nov', 'Nov', 'Nov', 'Dec', 'Dec', 'Dec', 'Dec', 'Jan', 'Jan', 'Jan'];
                const days = [25, 2, 9, 16, 23, 30, 6, 13, 20, 27, 4, 11, 18, 25, 1];

                // Sample teams for rotation in template weeks
                const sampleTeams = [
                    "Buffalo Bills", "Miami Dolphins", "New England Patriots", "New York Jets",
                    "Baltimore Ravens", "Cincinnati Bengals", "Cleveland Browns", "Pittsburgh Steelers",
                    "Houston Texans", "Indianapolis Colts", "Jacksonville Jaguars", "Tennessee Titans",
                    "Denver Broncos", "Kansas City Chiefs", "Las Vegas Raiders", "Los Angeles Chargers",
                    "Dallas Cowboys", "New York Giants", "Philadelphia Eagles", "Washington Commanders",
                    "Chicago Bears", "Detroit Lions", "Green Bay Packers", "Minnesota Vikings",
                    "Atlanta Falcons", "Carolina Panthers", "New Orleans Saints", "Tampa Bay Buccaneers",
                    "Arizona Cardinals", "Los Angeles Rams", "San Francisco 49ers", "Seattle Seahawks"
                ];

                for (let week = 4; week <= 18; week++) {
                    const monthIndex = week - 4;
                    const month = months[monthIndex] || 'Jan';
                    const day = days[monthIndex] || week;

                    const games = [];

                    // Thursday Night Game
                    games.push({
                        away: sampleTeams[(week * 2) % 32],
                        home: sampleTeams[(week * 2 + 1) % 32],
                        date: `Thursday, ${month} ${day}`,
                        time: "8:15 PM ET",
                        network: "Prime Video"
                    });

                    // Sunday 1PM games (8 games)
                    for (let i = 0; i < 8; i++) {
                        games.push({
                            away: sampleTeams[(week * 3 + i * 2) % 32],
                            home: sampleTeams[(week * 3 + i * 2 + 1) % 32],
                            date: `Sunday, ${month} ${day + 3}`,
                            time: "1:00 PM ET",
                            network: i % 2 === 0 ? "CBS" : "FOX"
                        });
                    }

                    // Sunday 4PM games (4 games)
                    for (let i = 0; i < 4; i++) {
                        games.push({
                            away: sampleTeams[(week * 4 + i * 2) % 32],
                            home: sampleTeams[(week * 4 + i * 2 + 1) % 32],
                            date: `Sunday, ${month} ${day + 3}`,
                            time: i < 2 ? "4:05 PM ET" : "4:25 PM ET",
                            network: i < 2 ? "FOX" : "CBS"
                        });
                    }

                    // Sunday Night Football
                    games.push({
                        away: sampleTeams[(week * 5) % 32],
                        home: sampleTeams[(week * 5 + 1) % 32],
                        date: `Sunday, ${month} ${day + 3}`,
                        time: "8:20 PM ET",
                        network: "NBC"
                    });

                    // Monday Night Football
                    games.push({
                        away: sampleTeams[(week * 6) % 32],
                        home: sampleTeams[(week * 6 + 1) % 32],
                        date: `Monday, ${month} ${day + 4}`,
                        time: "8:15 PM ET",
                        network: "ABC/ESPN"
                    });

                    this.nflSchedule[week] = {
                        week_number: week,
                        start_date: `2025-${month.toLowerCase()}-${day.toString().padStart(2, '0')}`,
                        games: games
                    };
                }

                return this.nflSchedule;
            }

            init() {
                try {
                    this.loadData();
                    this.bindEvents();
                    this.checkAdminAccess();
                    this.updateUI();
                    this.renderSeasonCalendar();
                    console.log('✅ Complete 18-week system loaded successfully!');
                } catch (error) {
                    console.error('❌ Initialization error:', error);
                }
            }

            showNotification(message, type = 'info') {
                // Remove existing notification
                const existing = document.querySelector('.notification');
                if (existing) existing.remove();

                // Create new notification
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                document.body.appendChild(notification);

                // Auto-remove after 3 seconds
                if (this.notificationTimeout) clearTimeout(this.notificationTimeout);
                this.notificationTimeout = setTimeout(() => {
                    notification.remove();
                }, 3000);

                console.log(`📢 ${type.toUpperCase()}: ${message}`);
            }

            loadData() {
                const savedData = localStorage.getItem('nflPickEmPool18Week');
                if (savedData) {
                    try {
                        const data = JSON.parse(savedData);
                        this.players = data.players || [];
                        this.currentWeek = data.currentWeek || 1;
                        this.entryFee = data.entryFee || 20;
                        console.log(`📁 Loaded: ${this.players.length} players, Week ${this.currentWeek}`);
                    } catch (error) {
                        console.error('Error loading saved data:', error);
                        this.createSampleData();
                    }
                } else {
                    this.createSampleData();
                }
            }

            createSampleData() {
                this.players = [
                    { 
                        id: 1, 
                        name: "John Smith", 
                        picks: {}, 
                        points: 0,
                        record: { wins: 0, losses: 0 }
                    },
                    { 
                        id: 2, 
                        name: "Sarah Johnson", 
                        picks: {}, 
                        points: 0,
                        record: { wins: 0, losses: 0 }
                    },
                    { 
                        id: 3, 
                        name: "Mike Davis", 
                        picks: {}, 
                        points: 0,
                        record: { wins: 0, losses: 0 }
                    }
                ];
                console.log('📝 Created sample data');
                this.saveData();
            }

            saveData() {
                try {
                    const data = {
                        players: this.players,
                        currentWeek: this.currentWeek,
                        entryFee: this.entryFee,
                        lastUpdated: new Date().toISOString()
                    };
                    localStorage.setItem('nflPickEmPool18Week', JSON.stringify(data));
                    return true;
                } catch (error) {
                    console.error('💾 Save error:', error);
                    this.showNotification('Failed to save data', 'error');
                    return false;
                }
            }

            bindEvents() {
                if (this.eventsBound) return;
                this.eventsBound = true;

                // Tab navigation
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // Week navigation
                document.getElementById('prev-week')?.addEventListener('click', () => {
                    this.changeWeek(-1);
                });
                document.getElementById('next-week')?.addEventListener('click', () => {
                    this.changeWeek(1);
                });

                // Player selection
                document.getElementById('current-player')?.addEventListener('change', (e) => {
                    this.selectPlayer(e.target.value);
                });

                // Submit pick
                document.getElementById('submit-pick')?.addEventListener('click', () => {
                    this.submitPick();
                });

                // Admin functions
                document.getElementById('add-player')?.addEventListener('click', () => {
                    this.addPlayer();
                });

                document.getElementById('new-player-name')?.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addPlayer();
                });

                document.getElementById('update-week')?.addEventListener('click', () => {
                    this.updateCurrentWeek();
                });

                document.getElementById('advance-week')?.addEventListener('click', () => {
                    this.advanceWeek();
                });

                document.getElementById('update-settings')?.addEventListener('click', () => {
                    this.updateSettings();
                });

                document.getElementById('reset-pool')?.addEventListener('click', () => {
                    this.resetPool();
                });

                document.getElementById('clear-picks')?.addEventListener('click', () => {
                    this.clearAllPicks();
                });

                console.log('🔗 Events bound successfully');
            }

            checkAdminAccess() {
                const showAdmin = () => {
                    const adminTab = document.getElementById('admin-tab');
                    if (adminTab) {
                        adminTab.style.display = 'inline-block';
                        this.switchTab('admin');

                        const title = document.getElementById('main-title');
                        if (title && !title.innerHTML.includes('[ADMIN]')) {
                            title.innerHTML += ' <span style="font-size: 0.6em; opacity: 0.7;">[ADMIN]</span>';
                        }
                    }
                };

                if (window.location.hash === '#admin') {
                    showAdmin();
                }

                window.addEventListener('hashchange', () => {
                    if (window.location.hash === '#admin') {
                        showAdmin();
                    } else {
                        const adminTab = document.getElementById('admin-tab');
                        if (adminTab) adminTab.style.display = 'none';
                        if (document.querySelector('.nav-tab[data-tab="admin"]')?.classList.contains('active')) {
                            this.switchTab('picks');
                        }
                    }
                });
            }

            switchTab(tabName) {
                // Hide all tabs
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active');
                });

                // Show selected tab
                const targetTab = document.getElementById(tabName);
                const targetNavTab = document.querySelector(`[data-tab="${tabName}"]`);

                if (targetTab) targetTab.classList.add('active');
                if (targetNavTab) targetNavTab.classList.add('active');

                // Update content based on tab
                if (tabName === 'standings') {
                    this.renderStandings();
                } else if (tabName === 'admin') {
                    this.renderAdminPanel();
                } else if (tabName === 'calendar') {
                    this.renderSeasonCalendar();
                }
            }

            updateUI() {
                this.updatePoolInfo();
                this.updateWeekStatus();
                this.updatePlayerDropdown();
                this.updateWeekDisplay();
                this.updateSeasonProgress();
            }

            updatePoolInfo() {
                const totalPlayers = this.players.length;
                const totalPot = totalPlayers * this.entryFee;

                document.getElementById('pool-size').textContent = `${totalPlayers} players`;
                document.getElementById('total-pot').textContent = `$${totalPot}`;
                document.getElementById('current-week-display').textContent = `Week ${this.currentWeek}`;
                document.getElementById('season-progress').textContent = `Week ${this.currentWeek} of ${this.maxWeeks}`;
            }

            updateSeasonProgress() {
                const progressPercent = (this.currentWeek / this.maxWeeks) * 100;
                const progressBar = document.getElementById('season-progress-bar');
                const weeksCompleted = this.currentWeek - 1;
                const weeksRemaining = this.maxWeeks - (this.currentWeek - 1);

                if (progressBar) {
                    progressBar.style.width = `${progressPercent}%`;
                }

                document.getElementById('weeks-completed').textContent = weeksCompleted;
                document.getElementById('weeks-remaining').textContent = weeksRemaining;
            }

            updateWeekStatus() {
                const statusElement = document.getElementById('week-status');
                const statusText = document.getElementById('status-text');

                if (statusElement && statusText) {
                    statusText.textContent = `Week ${this.currentWeek} - Picks Open`;
                    statusElement.className = 'week-status upcoming';
                }
            }

            updatePlayerDropdown() {
                const select = document.getElementById('current-player');
                if (!select) return;

                select.innerHTML = '<option value="">Choose a player...</option>';

                this.players.forEach(player => {
                    const option = document.createElement('option');
                    option.value = player.id;
                    option.textContent = player.name;
                    select.appendChild(option);
                });
            }

            updateWeekDisplay() {
                document.getElementById('week-title').textContent = `Week ${this.currentWeek}`;
                document.getElementById('display-week-number').textContent = this.currentWeek;
                document.getElementById('submit-week-number').textContent = this.currentWeek;
                document.getElementById('admin-current-week').value = this.currentWeek;
            }

            renderSeasonCalendar() {
                const calendarContainer = document.getElementById('season-calendar');
                if (!calendarContainer) return;

                calendarContainer.innerHTML = '';

                for (let week = 1; week <= this.maxWeeks; week++) {
                    const weekElement = document.createElement('div');
                    weekElement.className = 'calendar-week';

                    if (week === this.currentWeek) {
                        weekElement.classList.add('active');
                    }

                    weekElement.innerHTML = `
                        <div style="font-weight: bold;">Week ${week}</div>
                        <div style="font-size: 0.8em; margin-top: 5px;">
                            ${this.nflSchedule[week]?.start_date || 'TBD'}
                        </div>
                    `;

                    weekElement.addEventListener('click', () => {
                        this.currentWeek = week;
                        this.saveData();
                        this.updateUI();
                        this.renderSeasonCalendar();
                        this.switchTab('picks');
                        this.showNotification(`Jumped to Week ${week}`, 'info');
                    });

                    calendarContainer.appendChild(weekElement);
                }
            }

            selectPlayer(playerId) {
                if (!playerId) {
                    const weekData = this.nflSchedule[this.currentWeek];
                    const gameCount = weekData?.games?.length || 0;
                    document.getElementById('games-display').innerHTML = 
                        `<p style="text-align: center; color: var(--nfl-silver); padding: 40px;">
                            Select a player above to see all ${gameCount} games and make picks for Week ${this.currentWeek}.
                        </p>`;
                    document.getElementById('constraints-section').style.display = 'none';
                    document.getElementById('submit-section').style.display = 'none';
                    this.selectedPlayer = null;
                    return;
                }

                const player = this.players.find(p => p.id == playerId);
                if (!player) return;

                this.selectedPlayer = player;
                this.renderPlayerGames(player);
                this.updatePlayerConstraints(player);

                document.getElementById('constraints-section').style.display = 'block';
                document.getElementById('selected-player-name').textContent = player.name;
            }

            renderPlayerGames(player) {
                const weekData = this.nflSchedule[this.currentWeek];
                if (!weekData || !weekData.games) {
                    document.getElementById('games-display').innerHTML = 
                        '<p style="text-align: center; color: var(--nfl-silver); padding: 40px;">No games available for this week.</p>';
                    return;
                }

                const weekKey = `week${this.currentWeek}`;
                const currentPick = player.picks[weekKey];
                const usedTeams = Object.values(player.picks || {});

                let gamesHTML = `
                    <h3 style="color: var(--nfl-blue); margin-bottom: 20px; text-align: center;">
                        Week ${this.currentWeek} Games - Pick ONE team for ${player.name}
                    </h3>
                    <div class="games-grid">
                `;

                weekData.games.forEach(game => {
                    const awayDisabled = usedTeams.includes(game.away);
                    const homeDisabled = usedTeams.includes(game.home);
                    const awaySelected = currentPick === game.away;
                    const homeSelected = currentPick === game.home;

                    gamesHTML += `
                        <div class="game-card">
                            <div class="game-header">
                                <span class="game-time">${game.date} • ${game.time}</span>
                                <span class="game-network">${game.network}</span>
                            </div>
                            <div class="matchup">
                                <div class="team-line">
                                    <span class="team-name">${game.away}</span>
                                    <span style="color: var(--nfl-silver);">@</span>
                                </div>
                                <div class="team-line">
                                    <span class="team-name">${game.home}</span>
                                </div>
                            </div>
                            <div class="pick-options">
                                <button class="pick-btn ${awaySelected ? 'selected' : ''} ${awayDisabled ? 'disabled' : ''}" 
                                        data-team="${game.away}" 
                                        ${awayDisabled ? 'disabled' : ''}
                                        ${awayDisabled ? `title="${player.name} already picked ${game.away}"` : ''}>
                                    ${this.getTeamAbbr(game.away)}
                                </button>
                                <button class="pick-btn ${homeSelected ? 'selected' : ''} ${homeDisabled ? 'disabled' : ''}" 
                                        data-team="${game.home}" 
                                        ${homeDisabled ? 'disabled' : ''}
                                        ${homeDisabled ? `title="${player.name} already picked ${game.home}"` : ''}>
                                    ${this.getTeamAbbr(game.home)}
                                </button>
                            </div>
                        </div>
                    `;
                });

                gamesHTML += '</div>';
                document.getElementById('games-display').innerHTML = gamesHTML;

                // Add event listeners to pick buttons
                document.querySelectorAll('.pick-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        if (!e.target.disabled) {
                            this.selectTeamPick(e.target);
                        }
                    });
                });

                // Show submit section if player has made a pick
                if (currentPick) {
                    document.getElementById('submit-section').style.display = 'block';
                }
            }

            getTeamAbbr(teamName) {
                const abbrs = {
                    'Arizona Cardinals': 'ARI', 'Atlanta Falcons': 'ATL', 'Baltimore Ravens': 'BAL',
                    'Buffalo Bills': 'BUF', 'Carolina Panthers': 'CAR', 'Chicago Bears': 'CHI',
                    'Cincinnati Bengals': 'CIN', 'Cleveland Browns': 'CLE', 'Dallas Cowboys': 'DAL',
                    'Denver Broncos': 'DEN', 'Detroit Lions': 'DET', 'Green Bay Packers': 'GB',
                    'Houston Texans': 'HOU', 'Indianapolis Colts': 'IND', 'Jacksonville Jaguars': 'JAX',
                    'Kansas City Chiefs': 'KC', 'Las Vegas Raiders': 'LV', 'Los Angeles Chargers': 'LAC',
                    'Los Angeles Rams': 'LAR', 'Miami Dolphins': 'MIA', 'Minnesota Vikings': 'MIN',
                    'New England Patriots': 'NE', 'New Orleans Saints': 'NO', 'New York Giants': 'NYG',
                    'New York Jets': 'NYJ', 'Philadelphia Eagles': 'PHI', 'Pittsburgh Steelers': 'PIT',
                    'San Francisco 49ers': 'SF', 'Seattle Seahawks': 'SEA', 'Tampa Bay Buccaneers': 'TB',
                    'Tennessee Titans': 'TEN', 'Washington Commanders': 'WSH'
                };
                return abbrs[teamName] || teamName.substring(0, 3).toUpperCase();
            }

            updatePlayerConstraints(player) {
                const usedTeams = Object.values(player.picks || {});
                const usedTeamsDisplay = document.getElementById('used-teams-display');
                const remainingCount = document.getElementById('remaining-teams-count');

                if (usedTeams.length === 0) {
                    usedTeamsDisplay.innerHTML = '<em>No teams used yet this season</em>';
                } else {
                    usedTeamsDisplay.innerHTML = usedTeams.map(team => 
                        `<span class="used-team">${team}</span>`
                    ).join('');
                }

                const remaining = 32 - usedTeams.length;
                remainingCount.textContent = `${remaining}/32 teams remaining`;
                remainingCount.style.color = remaining > 20 ? 'var(--success-green)' : 
                                            remaining > 10 ? 'var(--warning-orange)' : 'var(--danger-red)';
            }

            selectTeamPick(button) {
                if (!this.selectedPlayer) return;

                // Clear previous selections
                document.querySelectorAll('.pick-btn').forEach(btn => {
                    btn.classList.remove('selected');
                });

                // Select current team
                button.classList.add('selected');
                this.selectedTeam = button.dataset.team;

                // Show submit section
                document.getElementById('submit-section').style.display = 'block';
            }

            submitPick() {
                if (!this.selectedPlayer || !this.selectedTeam) {
                    this.showNotification('Please select both a player and a team.', 'error');
                    return;
                }

                const weekKey = `week${this.currentWeek}`;

                // Check if player already has a pick for this week
                if (this.selectedPlayer.picks[weekKey]) {
                    if (!confirm(`${this.selectedPlayer.name} already has a pick for Week ${this.currentWeek}. Replace it?`)) {
                        return;
                    }
                }

                // Save the pick
                this.selectedPlayer.picks[weekKey] = this.selectedTeam;

                if (this.saveData()) {
                    this.showNotification(`Pick submitted! ${this.selectedPlayer.name} picked ${this.selectedTeam} for Week ${this.currentWeek}`, 'success');

                    // Update UI
                    this.updatePlayerConstraints(this.selectedPlayer);
                    this.renderPlayerGames(this.selectedPlayer);
                    this.selectedTeam = null;
                }
            }

            changeWeek(direction) {
                const newWeek = this.currentWeek + direction;
                if (newWeek < 1 || newWeek > this.maxWeeks) {
                    this.showNotification(`Cannot go to Week ${newWeek} - outside valid range (1-${this.maxWeeks})`, 'error');
                    return;
                }

                this.currentWeek = newWeek;
                this.saveData();
                this.updateUI();
                this.renderSeasonCalendar();
                this.showNotification(`Changed to Week ${this.currentWeek}`, 'info');

                // Reset player selection when changing weeks
                document.getElementById('current-player').value = '';
                this.selectPlayer('');
            }

            // Rest of the methods remain the same...
            addPlayer() {
                const nameInput = document.getElementById('new-player-name');
                if (!nameInput) return;

                const name = nameInput.value.trim();
                if (!name) {
                    this.showNotification('Please enter a player name', 'error');
                    return;
                }

                if (this.players.some(p => p.name.toLowerCase() === name.toLowerCase())) {
                    this.showNotification('A player with that name already exists', 'error');
                    return;
                }

                const newPlayer = {
                    id: Date.now(),
                    name: name,
                    picks: {},
                    points: 0,
                    record: { wins: 0, losses: 0 }
                };

                this.players.push(newPlayer);
                nameInput.value = '';

                if (this.saveData()) {
                    this.showNotification(`${name} added to the pool!`, 'success');
                    this.updateUI();
                    this.renderAdminPanel();
                }
            }

            removePlayer(playerId) {
                const player = this.players.find(p => p.id === playerId);
                if (!player) return;

                if (confirm(`Remove ${player.name} from the pool? This cannot be undone.`)) {
                    this.players = this.players.filter(p => p.id !== playerId);

                    if (this.saveData()) {
                        this.showNotification(`${player.name} removed from pool`, 'success');
                        this.updateUI();
                        this.renderAdminPanel();
                    }
                }
            }

            renderAdminPanel() {
                this.renderPlayerList();
            }

            renderPlayerList() {
                const playerList = document.getElementById('player-list');
                if (!playerList) return;

                if (this.players.length === 0) {
                    playerList.innerHTML = '<p style="color: var(--nfl-silver); font-style: italic;">No players yet. Add some above!</p>';
                    return;
                }

                playerList.innerHTML = '';

                this.players.forEach(player => {
                    const totalPicks = Object.keys(player.picks || {}).length;

                    const playerDiv = document.createElement('div');
                    playerDiv.className = 'player-item';
                    playerDiv.innerHTML = `
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <div class="player-stats">${player.points} points • ${totalPicks} picks made • ${32-totalPicks} teams remaining</div>
                        </div>
                        <button class="btn btn--danger btn--sm remove-player-btn" data-player-id="${player.id}">Remove</button>
                    `;

                    playerList.appendChild(playerDiv);
                });

                // Add remove button listeners
                document.querySelectorAll('.remove-player-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const playerId = parseInt(e.target.dataset.playerId);
                        this.removePlayer(playerId);
                    });
                });
            }

            renderStandings() {
                const tbody = document.getElementById('standings-tbody');
                if (!tbody) return;

                if (this.players.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: var(--nfl-silver); font-style: italic;">No players in pool yet</td></tr>';
                    return;
                }

                // Sort players by points
                const sortedPlayers = [...this.players].sort((a, b) => (b.points || 0) - (a.points || 0));

                tbody.innerHTML = '';

                sortedPlayers.forEach((player, index) => {
                    const teamsUsed = Object.keys(player.picks || {}).length;
                    const teamsRemaining = 32 - teamsUsed;
                    const wins = player.record?.wins || 0;
                    const losses = player.record?.losses || 0;

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="rank-cell">${index + 1}</td>
                        <td><strong>${player.name}</strong></td>
                        <td class="points-cell">${player.points || 0}</td>
                        <td>${wins}-${losses}</td>
                        <td>${teamsUsed}</td>
                        <td>${teamsRemaining}</td>
                    `;
                    tbody.appendChild(row);
                });
            }

            updateCurrentWeek() {
                const weekSelect = document.getElementById('admin-current-week');
                if (weekSelect) {
                    this.currentWeek = parseInt(weekSelect.value) || 1;
                    this.saveData();
                    this.updateUI();
                    this.renderSeasonCalendar();
                    // Reset player selection when changing weeks
                    document.getElementById('current-player').value = '';
                    this.selectPlayer('');
                    this.showNotification(`Week updated to ${this.currentWeek}`, 'success');
                }
            }

            advanceWeek() {
                if (this.currentWeek >= this.maxWeeks) {
                    this.showNotification('Already at final week of season', 'error');
                    return;
                }

                if (confirm(`Advance to Week ${this.currentWeek + 1}?`)) {
                    this.currentWeek++;
                    this.saveData();
                    this.updateUI();
                    this.renderSeasonCalendar();
                    // Reset player selection when advancing weeks
                    document.getElementById('current-player').value = '';
                    this.selectPlayer('');
                    this.showNotification(`Advanced to Week ${this.currentWeek}`, 'success');
                }
            }

            updateSettings() {
                const entryFeeInput = document.getElementById('entry-fee');
                if (entryFeeInput) {
                    this.entryFee = parseInt(entryFeeInput.value) || 20;
                    this.saveData();
                    this.updateUI();
                    this.showNotification('Settings updated successfully', 'success');
                }
            }

            resetPool() {
                if (confirm('Reset the entire pool? This will remove all players and picks. This cannot be undone!')) {
                    if (confirm('Are you absolutely sure? This will delete EVERYTHING!')) {
                        this.players = [];
                        this.currentWeek = 1;
                        this.entryFee = 20;
                        localStorage.removeItem('nflPickEmPool18Week');
                        this.updateUI();
                        this.renderAdminPanel();
                        this.renderSeasonCalendar();
                        this.showNotification('Pool has been completely reset', 'success');
                    }
                }
            }

            clearAllPicks() {
                if (confirm('Clear all picks for all players? Players will remain, but all their picks will be removed.')) {
                    this.players.forEach(player => {
                        player.picks = {};
                        player.points = 0;
                        player.record = { wins: 0, losses: 0 };
                    });

                    this.saveData();
                    this.updateUI();
                    this.renderAdminPanel();
                    this.showNotification('All picks cleared', 'success');
                }
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 Starting Complete 18-Week NFL Pick-Em Pool...');
            try {
                window.pickemPool = new Complete18WeekPickEmPool();
            } catch (error) {
                console.error('❌ Initialization failed:', error);
            }
        });
    </script>
</body>
</html>
